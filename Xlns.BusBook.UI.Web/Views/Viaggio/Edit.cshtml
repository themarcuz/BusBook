@using Xlns.BusBook.UI.Web.Models;
@model Xlns.BusBook.Core.Model.Viaggio
@{
    ViewBag.Title = "Edit";
}
@{
    if (Model.Id == 0)
    {
        ViewBag.Title = "Nuovo viaggio";
    }
    else
    {
        ViewBag.Title = "Modifica viaggio";
    }
}
@section scripts{
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $(".datepicker").datepicker(
                                    {
                                        dateFormat: "dd MM yy"
                                    });
        });
    </script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script src="@Url.Content("~/Content/scripts/viaggio.tappe.edit.js")" type="text/javascript"></script>
}
<div id="content-wrapper" class="container_16">
    <div id="main" class="grid_16">
        <h3>
            @ViewBag.Title</h3>
        <div style="display: table">
            <div style="display: table-row">
                <div style="display: table-cell">
                    @using (Html.BeginForm("Save", "Viaggio", FormMethod.Post, new { id = "salvaViaggioForm" }))
                    {
                        @Html.ValidationSummary(true)
                        <fieldset>
                            <div class="editor-label">
                                @Html.LabelFor(model => model.Nome)
                            </div>
                            <div class="editor-field">
                                @Html.TextBoxFor(model => model.Nome, new { style = "width: 300px" })
                                @Html.ValidationMessageFor(model => model.Nome)
                            </div>
                            <div class="editor-label">
                                @Html.LabelFor(model => model.Descrizione)
                            </div>
                            <div class="editor-field">
                                @Html.TextAreaFor(model => model.Descrizione, 3, 50, null)
                                @Html.ValidationMessageFor(model => model.Descrizione)
                            </div>
                            <div class="editor-label">
                                @Html.LabelFor(model => model.DataPartenza)
                            </div>
                            <div class="editor-field">
                                @Html.TextBox("DataPartenza", string.Format(ModelMetadata.FromLambdaExpression(m => m.DataPartenza, ViewData).DisplayFormatString, Model.DataPartenza), new { @class = "datepicker" })
                                @Html.ValidationMessageFor(model => model.DataPartenza)
                            </div>
                            <div class="editor-label">
                                @Html.LabelFor(model => model.DataChiusuraPrenotazioni)
                            </div>
                            <div class="editor-field">
                                @Html.TextBox("DataChiusuraPrenotazioni", string.Format(ModelMetadata.FromLambdaExpression(m => m.DataChiusuraPrenotazioni, ViewData).DisplayFormatString, Model.DataChiusuraPrenotazioni), new { @class = "datepicker" })
                                @Html.ValidationMessageFor(model => model.DataChiusuraPrenotazioni)
                            </div>
                            @Html.HiddenFor(model => model.Id)
                            <p>
                                <input type="submit" value="Salva" class="button" />
                                <input type="button" value="Annulla" id="cancelButton" class="button" 
                                    onclick="window.location='@Href("~/Viaggio/List")'" />
                            </p>
                        </fieldset>
                    }
                </div>
                <div style="display: table-cell; padding-left: 50px">
                    @if (Model.Id != 0)
                    {
                        <div id="ListaTappeEditabili">
                            @{Html.RenderAction("EditTappeViaggio", new { idViaggio = Model.Id });
                            }                           
                        </div>
                        <div id="EditTappaDialog" style="display: none">                           
                        </div>                       
                    }
                </div>
            </div>
        </div>
    </div>
</div>
